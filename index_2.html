<html>
    <head>
        <link rel="stylesheet" href="unbxdAutosuggest.css">
        <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0/handlebars.min.js"></script>
        <script src="//code.jquery.com/jquery-1.10.2.js"></script>
        <script src="unbxdAutosuggest.js"></script>
        <style>
            #autoSuggestResults {
                position: relative;
            }
            #unbxdInput {
                width: 50%;
            }
        </style>
    </head>
    <body>
        <div id="autoSuggestResults">
        <input type="text" id="unbxdInput" />
        </div>
    </body>
    <script>
            const renderAutosuggest = function () {
        window.unbxdAutoSuggestFunction($, Handlebars);
        $("#unbxdInput").unbxdautocomplete({
                siteName: "ss-unbxd-dev-downies7871636539561"
                , APIKey: "d77847bb19b086453e3ad135ac0e72d1"
                , minChars: 1
                , showCarts: false
                , position: "relative"
                , integrations: {
                'universal': true
                }
                , template: (window.UNBXD_AUTO_CONFIG && window.UNBXD_AUTO_CONFIG.template) || "2column"
                , mainTpl: (window.UNBXD_AUTO_CONFIG && window.UNBXD_AUTO_CONFIG.mainTpl) || ['inFields', 'keywordSuggestions', 'topQueries', 'promotedSuggestions']
                , sideTpl: ['popularProducts']
                , sideContentOn: (window.UNBXD_AUTO_CONFIG && window.UNBXD_AUTO_CONFIG.sideContentOn) || "right"
                , cartType: "separate"
                , noResultTpl: "No results found."

                , onItemSelect: function (data) {
                if (data.type === "IN_FIELD" && data.filtername) {
                    if (data.filtername) {
                    window.location = window.location.origin + window.location.pathname + "?&q=" + encodeURIComponent(data.value) + "&filter=" + data.filtername + "_uFilter:" + encodeURIComponent('"' + data.filtervalue + '"');
                    } else {
                    window.location = window.location.origin + window.location.pathname + "?&q=" + encodeURIComponent(data.value);
                    }
                } else {
                    window.location = window.location.origin + window.location.pathname + "?&q=" + encodeURIComponent(data.value);
                }
                }
                , onCartClick: function (obj) {
                return true;
                }
                , isMobile: function () {
                if (document.body.clientWidth <= 480) {
                    return true;
                } else {
                    return false;
                }
                }
                , theme: "#666666"
                , sortByLength: true
                , inFields: {
                header: '',
                count: 1,
                showDefault: true,
                noOfInfields: 1
                },
                topQueries: {
                count: 2
                , header: ''
                },
                keywordSuggestions: {
                count: 2
                , header: ''
                }
                , popularProducts: {
                count: 6
                , price: true
                , priceFunctionOrKey: "price"
                , image: true
                , imageUrlOrFunction: "imageUrl"
                , currency: "$"
                , header: 'Popular Products'
                , name: true
                , nameFunctionOrKey: "title"
                , view: "grid"
                , rowCount: 3
                , fields: ['title', 'doctype', 'autosuggest', 'price', 'priceInc', 'imageUrl', 'productUrl', 'priceIncUSD', 'priceIncGBP', 'priceIncNZD', 'priceIncCAD', 'priceIncCNY', 'priceIncEUR', 'priceIncMXN']
                },
                trendingSearches: {
                    enabled: true
                },
                inputContainerSelector: "#unbxdInput",
                preferInputWidthTotalContent: true,
                preferOneColumnFullWidth: true,
                filtered: true,
                platform: 'io',
                preferInputWidthMainContent: true,
                hideOnResize: true,
                removeOnBackButton: true,
                
                resultsContainerSelector: "#autoSuggestResults",
                removeDuplicates: true,
                extraParams: {
                    __ts: (new Date()).getTime()
                }
                // processResultsStyles: function(pos){
                //     let counter = 0;
                //     const resultsObj = this.currentResults;
                //     const obArr = Object.keys(resultsObj);
                //     obArr.forEach((item)=> {
                //         if(resultsObj[item].length > 0) {
                //             counter = counter + 1
                //         }
                //     });
                //     const auElem = this.$results[0];
                //     const mainContent = auElem.querySelector(".unbxd-as-maincontent");
                //     if(counter === 1 ) {
                //         auElem.querySelector(".unbxd-as-sidecontent").style.width = "100%";
                //     }
                //     if(counter === 0 && mainContent ) {
                //         mainContent.style.width = "100%";
                //     } 
                //     return {
                //         top: "100%",
                //         left: "0"
                //     }
                // }
        });
    };
    renderAutosuggest();
    </script>
</html>

